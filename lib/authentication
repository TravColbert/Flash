'use strict'

module.exports = function () {
  console.log(`\tauthentication helper: ***${__dirname}***`)
  return {
    ensureLoggedIn: (req, res, next) => {
      const authenticated = req.isAuthenticated()
      console.log(`\t*** authenticated: ${authenticated}`)
      if (!authenticated) return res.redirect('/login')
      next()
    }
  }
}
